def isTopLevelBuild = gradle.getParent() == null
if (isTopLevelBuild) {
    settingsEvaluated { settings ->
        settings.buildCache {
            local {
                enabled = false
            }
            remote(HttpBuildCache) {
                enabled = true
                push = false
            }
        }
    }
} else {
    throw new IllegalStateException("Build validation only supported on top-level Gradle build.")
}
